{% extends 'base.html' %}

{% block head %}
  <title>{% if action == 'update' %}Edit Part{% else %}Add New Part{% endif %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/part_form.css') }}">
{% endblock %}

{% block body %}
<h1 style="text-align: center;">
  {% if action == 'update' %}Edit Part{% else %}Add New Part{% endif %}
</h1>

<form method="POST" class="form-wrapper">
  <div class="form-group">
    <label for="location">Location:</label>
    <input type="text" name="location" id="location" required
           value="{{ part.location if action == 'update' else '' }}">
  </div>

  <div class="form-group">
    <label for="description">Description:</label>
    <input type="text" name="description" id="description" required
           value="{{ part.description if action == 'update' else default_description }}">
  </div>
  <div class="button-row">
    <button type="button" onclick="window.history.back()">Cancel</button>
    <button type="submit">
      {% if action == 'update' %}Update Part{% else %}Add Part{% endif %}
    </button>
  </div>
</form>
{% endblock %}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Focus the description field
    const input = document.getElementById('location');
    if (input) input.focus();

    // If sessionStorage has returnTo, add it to the form
    const returnTo = sessionStorage.getItem('returnTo');
    if (returnTo) {
      const form = document.querySelector('form');
      const input = document.createElement('input');
      input.type = 'hidden';
      input.name = 'returnTo';
      input.value = returnTo;
      form.appendChild(input);
      sessionStorage.removeItem('returnTo');
    }
  });
</script>
{% endblock %}
