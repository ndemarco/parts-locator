<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
        {% block head %}{% endblock %}
    </head>
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const searchBox = document.getElementById('live-search');
        const resultsBox = document.getElementById('live-results');

        let timeout = null;

        searchBox.addEventListener('input', function () {
            clearTimeout(timeout);
            const query = searchBox.value;

            if (query.length < 2) {
                resultsBox.innerHTML = '';
                return;
            }

            timeout = setTimeout(() => {
                fetch(`/api/search?q=${encodeURIComponent(query)}`)
                    .then(response => response.json())
                    .then(data => {
                        if (!data.results.length) {
                            resultsBox.innerHTML = '<p style="text-align:left; margin:0.5em;">No results</p>';
                            return;
                        }

                        resultsBox.innerHTML = data.results.map(part => `
                            <a href="/update/${part.id}" style="text-decoration: none; color: inherit;">
                                <div style="padding: 5px; border-bottom: 1px solid #ccc;">
                                    <strong>${part.description}</strong><br>
                                    <small>${part.location} â€“ ${part.created}</small>
                                </div>
                            </a>
                        `).join('');
                    });
            }, 300); // debounce time
        });
    });
</script>

    <body>
        <header style="background: #eee; padding: 10px; text-align: center;">
            <input type="text" id="live-search" placeholder="Search parts..." style="width: 300px; padding: 5px;">
            <div id="live-results" style="background:white; max-height: 200px; overflow-y: auto; margin-top: 5px;"></div>
        </header>

    {% block body %}{% endblock %}
    </body>
</html>